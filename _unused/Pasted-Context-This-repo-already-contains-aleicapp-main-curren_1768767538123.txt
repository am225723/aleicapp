Context:
This repo already contains aleicapp-main (current app) and a read-only reference folder at reference/couplestherapy-main/ which contains the full legacy Couples Therapy app (mobile + supabase).

Goal:
Upgrade aleicapp-main so it includes everything from couplestherapy-main (features, flows, data persistence), while keeping aleicapp-main’s newer UI, navigation structure, and Expo setup.

⸻

1) Confirm legacy paths (do not modify reference)
	•	Detect the correct legacy paths under reference/couplestherapy-main/:
	•	Legacy mobile app source (expected: reference/couplestherapy-main/mobile/src)
	•	Legacy Supabase config (expected: reference/couplestherapy-main/supabase)
	•	Treat everything under reference/ as read-only.

⸻

2) Generate a diff-based port plan

Create PORT_PLAN.md with:
	•	All legacy screens found in reference/couplestherapy-main/mobile/src/screens
	•	All current screens in client/screens
	•	Sections:
	•	Missing in aleicapp
	•	Already present
	•	New in aleicapp (keep)
	•	For each missing screen:
	•	Required services/hooks
	•	Required Supabase tables/storage
	•	Where it should live in aleicapp navigation (tab / stack)

⸻

3) Bring Supabase into aleicapp (no mocks)
	•	Copy reference/couplestherapy-main/supabase into repo root as supabase/
	•	Add client/lib/supabase.ts using:
	•	EXPO_PUBLIC_SUPABASE_URL
	•	EXPO_PUBLIC_SUPABASE_ANON_KEY
	•	Replace all mocked auth in client/contexts/AuthContext.tsx with real Supabase auth:
	•	restore session on app load
	•	auth state change listener
	•	sign up / sign in / sign out
	•	Use the profiles table to determine role (couple vs therapist)
	•	Ensure role-based navigation still works

⸻

4) Port legacy screens into aleicapp (feature parity)

Port missing screens from
reference/couplestherapy-main/mobile/src/screens
into
client/screens

Adapt them to:
	•	aleicapp’s component system
	•	aleicapp’s navigation patterns
	•	Supabase data access instead of local/in-memory state

Required parity features:
	•	Couple messaging + therapist messaging (realtime)
	•	Calendar
	•	Couple journal
	•	Gratitude log
	•	Rituals
	•	Shared goals
	•	Voice memos (record, upload, playback via Supabase Storage)
	•	Invitation codes
	•	Therapist couple list/dashboard
	•	All assessments/modules present in the legacy app

No screen may be ported without:
	•	navigation entry
	•	persistent data backing

⸻

5) Services layer (make screens real)
	•	Port or recreate required services/hooks:
	•	Supabase query helpers
	•	Realtime subscriptions (chat)
	•	Storage helpers (voice memos, attachments)
	•	Remove all placeholder or in-memory data for core features

⸻

6) Server (only if necessary)
	•	Keep server/ only for server-only responsibilities (webhooks, admin ops, secrets)
	•	Prefer Supabase + RLS for standard CRUD
	•	Do not duplicate logic unnecessarily

⸻

7) Guardrails
	•	Small, logical commits
	•	App must compile and launch after each major step
	•	No TODO stubs for auth, navigation, or persistence
	•	reference/couplestherapy-main must remain unchanged

⸻

8) Deliverables
	•	PORT_PLAN.md
	•	Working Supabase-backed auth + role routing
	•	Feature-complete aleicapp with all legacy functionality
	•	Updated README with Supabase setup instructions
	•	App builds successfully